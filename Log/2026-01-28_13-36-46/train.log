2026-01-28 13:36:47,167 - INFO - 开始无监督跨模态对比学习训练
2026-01-28 13:36:47,167 - INFO - 命令行参数: {'config': '../DataLoader/config.yaml', 'epochs': 300, 'batch_size': 8, 'lr': 0.001, 'device': 'cuda', 'gpus': '0', 'num_workers': 4, 'log_dir': '../Log', 'checkpoint_dir': '../Checkpoints', 'freeze_backbone': True, 'lambda_gen': 1.0}
2026-01-28 13:36:47,192 - INFO - 使用的显卡ID: [0]
2026-01-28 13:36:47,192 - INFO - 使用设备: cuda
2026-01-28 13:36:47,192 - INFO - 创建数据加载器...
2026-01-28 13:36:49,229 - INFO - 数据加载器创建完成，训练样本数: 12311, 批次大小: 8, 批次数量: 1538
2026-01-28 13:36:49,282 - INFO - 
=== Batch Size 建议 ===
2026-01-28 13:36:49,282 - INFO - 当前设置: batch_size=8, 使用显卡数=1
2026-01-28 13:36:49,282 - INFO - 注意：在multi_view_visual_encoder.py中，实际传入Backbone的图片数量会被放大为 B * N * NUM_NEIGHBOURS
2026-01-28 13:36:49,283 - INFO - 例如：如果N=4, NUM_NEIGHBOURS=5，那么每张显卡需要处理的图片数为: (16 * 4 * 5) / 1 = 320.0张
2026-01-28 13:36:49,283 - INFO - 
建议：在多卡环境下，您可以将batch size设置为 8 ~ 8
2026-01-28 13:36:49,283 - INFO - 这样每张显卡处理的实际图片数量会更合理，减少显存压力
2026-01-28 13:36:49,283 - INFO - 初始化模型...
2026-01-28 13:36:49,967 - INFO - 是否冻结ResNet Backbone: True
2026-01-28 13:36:50,940 - INFO - 开始训练...
2026-01-28 13:36:50,961 - INFO - Epoch 1/300
2026-01-28 13:47:35,208 - INFO - Epoch 1 平均损失: Total=2.0414, Intra=2.0245, Gen=0.0169
2026-01-28 13:47:35,209 - INFO - 当前学习率: 0.001000
2026-01-28 13:47:58,353 - INFO - 新的最优模型已保存，总损失: 2.0414
2026-01-28 13:47:58,354 - INFO - Epoch 2/300
2026-01-28 13:52:09,394 - INFO - Epoch 2 平均损失: Total=1.9886, Intra=1.9823, Gen=0.0062
2026-01-28 13:52:09,395 - INFO - 当前学习率: 0.001000
2026-01-28 13:52:25,354 - INFO - 新的最优模型已保存，总损失: 1.9886
2026-01-28 13:52:25,354 - INFO - Epoch 3/300
